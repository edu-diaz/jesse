# Jesse Trade Bot Kubernetes deployment documentation

This document provides a comprehensive guide for deploying the Jesse trade bot using the Helm chart provided in this repository. For detailed information about the chart itself, refer to the [README.md](jesse/README.md) file.

## Prerequisites

1. **Kubernetes cluster**

   - Ensure you have a running Kubernetes cluster. You can use a local cluster like [kind](https://kind.sigs.k8s.io/) for testing purposes.

2. **Helm**

   - Install Helm on your local machine. Follow the instructions [here](https://helm.sh/docs/intro/install/).

## Steps to Deploy

### Step 1 (optional): create a Kind cluster

For testing purposes, you can create a kind cluster:

```bash
kind create cluster --name jesse-cluster
```

### Step 2: configure Jesse

Add the `LICENSE_API_TOKEN` within the `config` field from the `charts/jesse/values.yaml` file according to Jesse's [documentation](https://docs.jesse.trade/docs/configuration#environment-variables).

### Step 3: Install the Helm chart

Navigate to the root of this repository and deploy the chart using:

```bash
helm dependency update charts/jesse
helm install jesse charts/jesse --namespace jesse-namespace --create-namespace -f charts/jesse/values.yaml
```

### Step 4: Verify the deployment

Wair for the deployment to be ready (it can take up to a minute):

```bash
kubectl wait --for=condition=available --namespace jesse-namespace deployment/jesse --timeout=120s
```

Ensure all the pods, services, and ingress resources are created and running as expected:

```bash
kubectl get all --namespace jesse-namespace
```

### Step 5: Expose the service

The service is exposed as a `ClusterIP` by default. To access it externally, you can use port forwarding or an ingress resource. The Helm chart's `NOTES.txt` provides details on accessing the service.

#### Using port forwarding

```bash
kubectl port-forward svc/jesse 8080:9000 -n jesse-namespace
```

You can then access the application at `http://localhost:8080`.

#### Using Ingress (recommended for Production)

Enable ingress by setting the following values:

```yaml
ingress:
  enabled: true
  hosts:
    - host: jesse.local
      paths:
        - path: /
          pathType: ImplementationSpecific
```

Deploy the chart with the above values and ensure your DNS resolves `jesse.local` to the ingress controller's IP address.

## Cleanup

To remove the deployment, run the following commands:

```bash
helm uninstall jesse --namespace jesse-namespace
kubectl delete namespace jesse-namespace
```

## Additional Information

- For troubleshooting or additional configuration, consult the `NOTES.txt` generated by the Helm chart or refer to the official [Jesse documentation](https://jesse.trade/).
- Advanced users can modify the `values.yaml` file to fit specific deployment needs.

---

Happy trading!
